<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Protocol Layer &mdash; stompest documentation - v2.2.5</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.2.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="stompest documentation - v2.2.5" href="index.html" />
    <link rel="next" title="Configuration" href="config.html" />
    <link rel="prev" title="Asynchronous Client" href="async.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="config.html" title="Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="async.html" title="Asynchronous Client"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">stompest documentation - v2.2.5</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Protocol Layer</a><ul>
<li><a class="reference internal" href="#module-stompest.protocol.failover">Failover Transport</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.session">Session State</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.frame">STOMP Frame Representation</a></li>
<li><a class="reference internal" href="#commands">Commands</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.spec">STOMP Protocol Specification</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.parser">Wire-Level Parser</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="async.html"
                        title="previous chapter">Asynchronous Client</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="config.html"
                        title="next chapter">Configuration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/protocol.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-stompest.protocol">
<span id="protocol-layer"></span><span id="protocol"></span><h1>Protocol Layer<a class="headerlink" href="#module-stompest.protocol" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-stompest.protocol" title="stompest.protocol"><code class="xref py py-mod docutils literal"><span class="pre">protocol</span></code></a> package is a collection of generic components each of which you can use independently for your own STOMP related functionality.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please restrict your imports to the main package <a class="reference internal" href="#module-stompest.protocol" title="stompest.protocol"><code class="xref py py-mod docutils literal"><span class="pre">stompest.protocol</span></code></a>. The subpackage structure is potentially unstable.</p>
</div>
<div class="section" id="module-stompest.protocol.failover">
<span id="failover-transport"></span><h2>Failover Transport<a class="headerlink" href="#module-stompest.protocol.failover" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.failover.StompFailoverTransport">
<em class="property">class </em><code class="descclassname">stompest.protocol.failover.</code><code class="descname">StompFailoverTransport</code><span class="sig-paren">(</span><em>uri</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.failover.StompFailoverTransport" title="Permalink to this definition">¶</a></dt>
<dd><p>Looping over this object, you can produce a series of tuples (broker, delay in s). When the failover scheme does not allow further failover, a <a class="reference internal" href="error.html#stompest.error.StompConnectTimeout" title="stompest.error.StompConnectTimeout"><code class="xref py py-class docutils literal"><span class="pre">StompConnectTimeout</span></code></a> error is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uri</strong> &#8211; A failover URI.</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFailoverTransport</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.error</span> <span class="kn">import</span> <span class="n">StompConnectTimeout</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">failover</span> <span class="o">=</span> <span class="n">StompFailoverTransport</span><span class="p">(</span><span class="s1">&#39;failover:(tcp://remote1:61615,tcp://localhost:61616)?randomize=false,startupMaxReconnectAttempts=3,initialReconnectDelay=7,maxReconnectDelay=8,maxReconnectAttempts=0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span> <span class="ow">in</span> <span class="n">failover</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s1">&#39;broker: </span><span class="si">%s</span><span class="s1">, delay: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>                                                                       
<span class="gp">... </span><span class="k">except</span> <span class="n">StompConnectTimeout</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s1">&#39;timeout: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">e</span>
<span class="gp">... </span>
<span class="go">broker: {&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, delay: 0.000000</span>
<span class="go">broker: {&#39;host&#39;: &#39;localhost&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61616}, delay: 0.007000</span>
<span class="go">broker: {&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, delay: 0.008000</span>
<span class="go">broker: {&#39;host&#39;: &#39;localhost&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61616}, delay: 0.008000</span>
<span class="go">timeout: Reconnect timeout: 3 attempts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span> <span class="ow">in</span> <span class="n">failover</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s1">&#39;broker: </span><span class="si">%s</span><span class="s1">, delay: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">StompConnectTimeout</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s1">&#39;timeout: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">e</span>
<span class="gp">... </span>
<span class="go">broker: {&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, delay: 0.000000</span>
<span class="go">timeout: Reconnect timeout: 0 attempts</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#stompest.protocol.failover.StompFailoverUri" title="stompest.protocol.failover.StompFailoverUri"><code class="xref py py-class docutils literal"><span class="pre">StompFailoverUri</span></code></a> which parses failover transport URIs.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="stompest.protocol.failover.StompFailoverUri">
<em class="property">class </em><code class="descclassname">stompest.protocol.failover.</code><code class="descname">StompFailoverUri</code><span class="sig-paren">(</span><em>uri</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.failover.StompFailoverUri" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a parser for the failover URI scheme used in stompest. The parsed parameters are available in the attributes <code class="xref py py-attr docutils literal"><span class="pre">brokers</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">options</span></code>. The Failover transport syntax is very close to the one used in ActiveMQ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uri</strong> &#8211; <p>A failover URI. Its basic form is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;failover:(uri1,...,uriN)?transportOptions&#39;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s1">&#39;failover:uri1,...,uriN&#39;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFailoverUri</span>    
<span class="gp">&gt;&gt;&gt; </span><span class="n">uri</span> <span class="o">=</span> <span class="n">StompFailoverUri</span><span class="p">(</span><span class="s1">&#39;failover:(tcp://remote1:61615,tcp://localhost:61616)?randomize=false,startupMaxReconnectAttempts=3,initialReconnectDelay=7,maxReconnectDelay=8,maxReconnectAttempts=0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">uri</span><span class="o">.</span><span class="n">brokers</span>
<span class="go">[{&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, {&#39;host&#39;: &#39;localhost&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61616}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">uri</span><span class="o">.</span><span class="n">options</span>
<span class="go">{&#39;initialReconnectDelay&#39;: 7, &#39;maxReconnectDelay&#39;: 8, &#39;backOffMultiplier&#39;: 2.0, &#39;startupMaxReconnectAttempts&#39;: 3, &#39;priorityBackup&#39;: False, &#39;maxReconnectAttempts&#39;: 0, &#39;reconnectDelayJitter&#39;: 0, &#39;useExponentialBackOff&#39;: True, &#39;randomize&#39;: False}</span>
</pre></div>
</div>
<p><strong>Supported Options:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="3%" />
<col width="5%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">option</th>
<th class="head">type</th>
<th class="head">default</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>initialReconnectDelay</em></td>
<td>int</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">10</span></code></td>
<td>how long to wait before the first reconnect attempt (in ms)</td>
</tr>
<tr class="row-odd"><td><em>maxReconnectDelay</em></td>
<td>int</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">30000</span></code></td>
<td>the maximum amount of time we ever wait between reconnect attempts (in ms)</td>
</tr>
<tr class="row-even"><td><em>useExponentialBackOff</em></td>
<td>bool</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></td>
<td>should an exponential backoff be used between reconnect attempts</td>
</tr>
<tr class="row-odd"><td><em>backOffMultiplier</em></td>
<td>float</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">2.0</span></code></td>
<td>the exponent used in the exponential backoff attempts</td>
</tr>
<tr class="row-even"><td><em>maxReconnectAttempts</em></td>
<td>int</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">-1</span></code></td>
<td><code class="xref py py-obj docutils literal"><span class="pre">-1</span></code> means retry forever
<code class="xref py py-obj docutils literal"><span class="pre">0</span></code> means don&#8217;t retry (only try connection once but no retry)
<code class="xref py py-obj docutils literal"><span class="pre">&gt;</span> <span class="pre">0</span></code> means the maximum number of reconnect attempts before an error is sent back to the client</td>
</tr>
<tr class="row-odd"><td><em>startupMaxReconnectAttempts</em></td>
<td>int</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">0</span></code></td>
<td>if not <code class="xref py py-obj docutils literal"><span class="pre">0</span></code>, then this is the maximum number of reconnect attempts before an error is sent back to the client on the first attempt by the client to start a connection, once connected the <em>maxReconnectAttempts</em> option takes precedence</td>
</tr>
<tr class="row-even"><td><em>reconnectDelayJitter</em></td>
<td>int</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">0</span></code></td>
<td>jitter in ms by which reconnect delay is blurred in order to avoid stampeding</td>
</tr>
<tr class="row-odd"><td><em>randomize</em></td>
<td>bool</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">True</span></code></td>
<td>use a random algorithm to choose the the URI to use for reconnect from the list provided</td>
</tr>
<tr class="row-even"><td><em>priorityBackup</em></td>
<td>bool</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">False</span></code></td>
<td>if set, prefer local connections to remote connections</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#stompest.protocol.failover.StompFailoverTransport" title="stompest.protocol.failover.StompFailoverTransport"><code class="xref py py-class docutils literal"><span class="pre">StompFailoverTransport</span></code></a>, <a class="reference external" href="http://activemq.apache.org/failover-transport-reference.html">failover transport</a> of ActiveMQ.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.session">
<span id="session-state"></span><span id="session"></span><h2>Session State<a class="headerlink" href="#module-stompest.protocol.session" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><code class="xref py py-class docutils literal"><span class="pre">StompSession</span></code></a> object implements an abstract STOMP protocol session, where &#8220;abstract&#8221; means that it is entirely client or transport agnostic. The session API builds upon the low-level and stateless API of the <a class="reference internal" href="#module-stompest.protocol.commands" title="stompest.protocol.commands"><code class="xref py py-mod docutils literal"><span class="pre">protocol.commands</span></code></a> module, but it also keeps track of the session state (e.g., STOMP protocol version negotiation, active subscriptions). You can use the API provided by <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><code class="xref py py-class docutils literal"><span class="pre">StompSession</span></code></a> independently of the stompest clients to roll your own STOMP client.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Being stateful implies that the session keeps track of subscriptions, receipts, and transactions, so keep track of them yourself, too! &#8211; Unless you like to be surprised by a spurious <a class="reference internal" href="error.html#stompest.error.StompProtocolError" title="stompest.error.StompProtocolError"><code class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></code></a> ...</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The stateless API in the module <a class="reference internal" href="#module-stompest.protocol.commands" title="stompest.protocol.commands"><code class="xref py py-mod docutils literal"><span class="pre">protocol.commands</span></code></a> for all API command parameters which are not documented here.</p>
</div>
<p><strong>Example</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFrame</span><span class="p">,</span> <span class="n">StompSession</span><span class="p">,</span> <span class="n">StompSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">StompSession</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">VERSION_1_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">login</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">passcode</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">StompFrame(command=&#39;CONNECT&#39;, headers={&#39;passcode&#39;: &#39;&#39;, &#39;login&#39;: &#39;&#39;, &#39;host&#39;: &#39;&#39;, &#39;accept-version&#39;: &#39;1.0,1.1&#39;})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="go">1.1 connecting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">connected</span><span class="p">(</span><span class="n">StompFrame</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">CONNECTED</span><span class="p">,</span> <span class="p">{</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">SESSION_HEADER</span><span class="p">:</span> <span class="s1">&#39;tete-a-tete&#39;</span><span class="p">}))</span> <span class="c1"># The broker only understands STOMP 1.0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="go">1.0 connected</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
<span class="go">StompFrame(command=&#39;DISCONNECT&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="go">1.0 disconnecting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
<span class="go">1.1 disconnected</span>
</pre></div>
</div>
<dl class="class">
<dt id="stompest.protocol.session.StompSession">
<em class="property">class </em><code class="descclassname">stompest.protocol.session.</code><code class="descname">StompSession</code><span class="sig-paren">(</span><em>version=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession" title="Permalink to this definition">¶</a></dt>
<dd><p>This object implements an abstract STOMP protocol session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>version</strong> &#8211; The highest (and at the same time default) STOMP protocol version.</li>
<li><strong>check</strong> &#8211; This flag decides whether the session should accept commands only in the proper session states (<code class="xref py py-obj docutils literal"><span class="pre">True</span></code>) or in any session state (<code class="xref py py-obj docutils literal"><span class="pre">False</span></code>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="stompest.protocol.session.StompSession.abort">
<code class="descname">abort</code><span class="sig-paren">(</span><em>transaction</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ABORT</strong> frame to abort a STOMP transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.session.StompSession.transaction" title="stompest.protocol.session.StompSession.transaction"><code class="xref py py-meth docutils literal"><span class="pre">transaction()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you try and abort a transaction which is not pending, this will result in a <a class="reference internal" href="error.html#stompest.error.StompProtocolError" title="stompest.error.StompProtocolError"><code class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.ack">
<code class="descname">ack</code><span class="sig-paren">(</span><em>frame</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.ack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.beat">
<code class="descname">beat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.beat" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a STOMP heart-beat.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.begin">
<code class="descname">begin</code><span class="sig-paren">(</span><em>transaction=None</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>BEGIN</strong> frame and begin an abstract STOMP transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.session.StompSession.transaction" title="stompest.protocol.session.StompSession.transaction"><code class="xref py py-meth docutils literal"><span class="pre">transaction()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you try and begin a pending transaction twice, this will result in a <a class="reference internal" href="error.html#stompest.error.StompProtocolError" title="stompest.error.StompProtocolError"><code class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></code></a>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.clientHeartBeat">
<code class="descname">clientHeartBeat</code><a class="headerlink" href="#stompest.protocol.session.StompSession.clientHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>The negotiated client heart-beat period in ms.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.close">
<code class="descname">close</code><span class="sig-paren">(</span><em>flush=True</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean up the session: Set the state to <code class="xref py py-attr docutils literal"><span class="pre">DISCONNECTED</span></code>, remove all information related to an eventual broker connection, clear all pending transactions and receipts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flush</strong> &#8211; Clear all active subscriptions. This flag controls whether the next <a class="reference internal" href="#stompest.protocol.session.StompSession.connect" title="stompest.protocol.session.StompSession.connect"><code class="xref py py-meth docutils literal"><span class="pre">connect()</span></code></a> will replay the currently active subscriptions or will wipe the slate clean.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><em>transaction</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a <strong>COMMIT</strong> command to commit a STOMP transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.session.StompSession.transaction" title="stompest.protocol.session.StompSession.transaction"><code class="xref py py-meth docutils literal"><span class="pre">transaction()</span></code></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you try and commit a transaction which is not pending, this will result in a <a class="reference internal" href="error.html#stompest.error.StompProtocolError" title="stompest.error.StompProtocolError"><code class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><em>login=None</em>, <em>passcode=None</em>, <em>headers=None</em>, <em>versions=None</em>, <em>host=None</em>, <em>heartBeats=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>CONNECT</strong> frame and set the session state to <code class="xref py py-attr docutils literal"><span class="pre">CONNECTING</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.connected">
<code class="descname">connected</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>CONNECTED</strong> frame and set the session state to <code class="xref py py-attr docutils literal"><span class="pre">CONNECTED</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.disconnect">
<code class="descname">disconnect</code><span class="sig-paren">(</span><em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>DISCONNECT</strong> frame and set the session state to <code class="xref py py-attr docutils literal"><span class="pre">DISCONNECTING</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.id">
<code class="descname">id</code><a class="headerlink" href="#stompest.protocol.session.StompSession.id" title="Permalink to this definition">¶</a></dt>
<dd><p>The session id for the current client-broker connection.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.lastReceived">
<code class="descname">lastReceived</code><a class="headerlink" href="#stompest.protocol.session.StompSession.lastReceived" title="Permalink to this definition">¶</a></dt>
<dd><p>The last time when data was received.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.lastSent">
<code class="descname">lastSent</code><a class="headerlink" href="#stompest.protocol.session.StompSession.lastSent" title="Permalink to this definition">¶</a></dt>
<dd><p>The last time when data was sent.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.message">
<code class="descname">message</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>MESSAGE</strong> frame. Returns a token which you can use to match this message to its subscription.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#stompest.protocol.session.StompSession.subscribe" title="stompest.protocol.session.StompSession.subscribe"><code class="xref py py-meth docutils literal"><span class="pre">subscribe()</span></code></a> method.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.nack">
<code class="descname">nack</code><span class="sig-paren">(</span><em>frame</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.nack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>NACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.receipt">
<code class="descname">receipt</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.receipt" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>RECEIPT</strong> frame. Returns the receipt id which you can use to match this receipt to the command that requested it.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.received">
<code class="descname">received</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.received" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify the session that data was received (counts as server heart-beat).</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.replay">
<code class="descname">replay</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.replay" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush all active subscriptions and return an iterator over the <a class="reference internal" href="#stompest.protocol.session.StompSession.subscribe" title="stompest.protocol.session.StompSession.subscribe"><code class="xref py py-meth docutils literal"><span class="pre">subscribe()</span></code></a> parameters (<strong>destinations</strong>, <strong>header</strong>, <strong>receipt</strong>, <strong>context</strong>) which you can consume to replay the subscriptions upon the next <a class="reference internal" href="#stompest.protocol.session.StompSession.connect" title="stompest.protocol.session.StompSession.connect"><code class="xref py py-meth docutils literal"><span class="pre">connect()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.send">
<code class="descname">send</code><span class="sig-paren">(</span><em>destination</em>, <em>body=''</em>, <em>headers=None</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>SEND</strong> frame.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.sent">
<code class="descname">sent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.sent" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify the session that data was sent (counts as client heart-beat).</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.server">
<code class="descname">server</code><a class="headerlink" href="#stompest.protocol.session.StompSession.server" title="Permalink to this definition">¶</a></dt>
<dd><p>The server id for the current client-broker connection.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.serverHeartBeat">
<code class="descname">serverHeartBeat</code><a class="headerlink" href="#stompest.protocol.session.StompSession.serverHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>The negotiated server heart-beat period in ms.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.state">
<code class="descname">state</code><a class="headerlink" href="#stompest.protocol.session.StompSession.state" title="Permalink to this definition">¶</a></dt>
<dd><p>The current session state.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.subscribe">
<code class="descname">subscribe</code><span class="sig-paren">(</span><em>destination</em>, <em>headers=None</em>, <em>receipt=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.subscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>SUBSCRIBE</strong> frame and keep track of the subscription assiocated to it. This method returns a token which you have to keep if you wish to match incoming <strong>MESSAGE</strong> frames to this subscription with <a class="reference internal" href="#stompest.protocol.session.StompSession.message" title="stompest.protocol.session.StompSession.message"><code class="xref py py-meth docutils literal"><span class="pre">message()</span></code></a> or to <a class="reference internal" href="#stompest.protocol.session.StompSession.unsubscribe" title="stompest.protocol.session.StompSession.unsubscribe"><code class="xref py py-meth docutils literal"><span class="pre">unsubscribe()</span></code></a> later.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> &#8211; An arbitrary context object which you can use to store any information related to the subscription at hand.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.subscription">
<code class="descname">subscription</code><span class="sig-paren">(</span><em>token</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.subscription" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given subscription token, obtain the corresponding subscription context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>token</strong> &#8211; The result of the <a class="reference internal" href="#stompest.protocol.session.StompSession.subscribe" title="stompest.protocol.session.StompSession.subscribe"><code class="xref py py-meth docutils literal"><span class="pre">subscribe()</span></code></a> method call which you used to initiate the subscription in question.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.transaction">
<code class="descname">transaction</code><span class="sig-paren">(</span><em>transaction=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a transaction id which can be used for <a class="reference internal" href="#stompest.protocol.session.StompSession.begin" title="stompest.protocol.session.StompSession.begin"><code class="xref py py-meth docutils literal"><span class="pre">begin()</span></code></a>, <a class="reference internal" href="#stompest.protocol.session.StompSession.abort" title="stompest.protocol.session.StompSession.abort"><code class="xref py py-meth docutils literal"><span class="pre">abort()</span></code></a>, and <a class="reference internal" href="#stompest.protocol.session.StompSession.commit" title="stompest.protocol.session.StompSession.commit"><code class="xref py py-meth docutils literal"><span class="pre">commit()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; A valid transaction id, or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (automatically generate a unique id).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.unsubscribe">
<code class="descname">unsubscribe</code><span class="sig-paren">(</span><em>token</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.session.StompSession.unsubscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>UNSUBSCRIBE</strong> frame and lose track of the subscription assiocated to it.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.version">
<code class="descname">version</code><a class="headerlink" href="#stompest.protocol.session.StompSession.version" title="Permalink to this definition">¶</a></dt>
<dd><p>The STOMP protocol version of the current client-broker connection (if any), or the version you created this session with (otherwise).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.frame">
<span id="stomp-frame-representation"></span><span id="frame"></span><h2>STOMP Frame Representation<a class="headerlink" href="#module-stompest.protocol.frame" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.frame.StompFrame">
<em class="property">class </em><code class="descclassname">stompest.protocol.frame.</code><code class="descname">StompFrame</code><span class="sig-paren">(</span><em>command</em>, <em>headers=None</em>, <em>body=''</em>, <em>rawHeaders=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.frame.StompFrame" title="Permalink to this definition">¶</a></dt>
<dd><p>This object represents a STOMP frame.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param command:</th><td class="field-body">A valid STOMP command.</td>
</tr>
<tr class="field-even field"><th class="field-name">param headers:</th><td class="field-body">The STOMP headers (represented as a <code class="xref py py-class docutils literal"><span class="pre">dict</span></code>), or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (no headers).</td>
</tr>
<tr class="field-odd field"><th class="field-name">param body:</th><td class="field-body">The frame body. The body will be cast as a binary string <code class="xref py py-class docutils literal"><span class="pre">str</span></code> (Python 2) or <code class="xref py py-class docutils literal"><span class="pre">bytes</span></code> (Python 3).</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">param rawHeaders:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">The raw STOMP headers (represented as a collection of (header, value) pairs), or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (no raw headers).</td>
</tr>
<tr class="field-odd field"><th class="field-name">param version:</th><td class="field-body">A valid STOMP protocol version, or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (equivalent to the <code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_VERSION</span></code> attribute of the <a class="reference internal" href="#stompest.protocol.spec.StompSpec" title="stompest.protocol.spec.StompSpec"><code class="xref py py-class docutils literal"><span class="pre">StompSpec</span></code></a> class).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The frame&#8217;s attributes are internally stored as arbitrary Python objects. The frame&#8217;s <code class="xref py py-attr docutils literal"><span class="pre">version</span></code> attribute controls the wire-level encoding of its <code class="xref py py-attr docutils literal"><span class="pre">command</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">headers</span></code> (depending on STOMP protocol version, this may be ASCII or UTF-8), while its <code class="xref py py-attr docutils literal"><span class="pre">body</span></code> is not encoded at all (it&#8217;s just cast as a <code class="xref py py-class docutils literal"><span class="pre">str</span></code>).</p>
</div>
<p><strong>Example</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFrame</span><span class="p">,</span> <span class="n">StompSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">StompFrame</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">SEND</span><span class="p">,</span> <span class="n">rawHeaders</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar2&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span>
<span class="go">StompFrame(command=&#39;SEND&#39;, rawHeaders=[(&#39;foo&#39;, &#39;bar1&#39;), (&#39;foo&#39;, &#39;bar2&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">b&#39;SEND\nfoo:bar1\nfoo:bar2\n\n\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dict</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">{&#39;command&#39;: &#39;SEND&#39;, &#39;rawHeaders&#39;: [(&#39;foo&#39;, &#39;bar1&#39;), (&#39;foo&#39;, &#39;bar2&#39;)]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">headers</span>
<span class="go">{&#39;foo&#39;: &#39;bar1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar3&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">headers</span>
<span class="go">{&#39;foo&#39;: &#39;bar1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">unraw</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span>
<span class="go">StompFrame(command=&#39;SEND&#39;, headers={&#39;foo&#39;: &#39;bar1&#39;})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">b&#39;SEND\nfoo:bar1\n\n\x00&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="s1">&#39;bar4&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">headers</span>
<span class="go">{&#39;foo&#39;: &#39;bar4&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">StompFrame</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">SEND</span><span class="p">,</span> <span class="n">rawHeaders</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;some french&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s1">&#39;fenÃªtre&#39;</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))],</span> <span class="n">version</span><span class="o">=</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">VERSION_1_0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">UnicodeEncodeError</span>: <span class="n">&#39;ascii&#39; codec can&#39;t encode character &#39;ê&#39; in position 15: ordinal not in range(128)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">StompSpec</span><span class="o">.</span><span class="n">VERSION_1_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">b&#39;SEND</span>
</pre></div>
</div>
</div></blockquote>
<p>some french:fenÃªtre</p>
<dl class="docutils">
<dt>&#8216;</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">headers</span>
<span class="go">{&#39;some french&#39;: &#39;fenêtre&#39;}</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="stompest.protocol.frame.StompFrame.info">
<code class="descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.frame.StompFrame.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a log-friendly representation of the frame (show only non-trivial content, and truncate the message to INFO_LENGTH characters).</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.frame.StompFrame.unraw">
<code class="descname">unraw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.frame.StompFrame.unraw" title="Permalink to this definition">¶</a></dt>
<dd><p>If the frame has raw headers, copy their deduplicated version to the <code class="xref py py-attr docutils literal"><span class="pre">headers</span></code> attribute, and remove the raw headers afterwards.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stompest.protocol.frame.StompHeartBeat">
<em class="property">class </em><code class="descclassname">stompest.protocol.frame.</code><code class="descname">StompHeartBeat</code><a class="headerlink" href="#stompest.protocol.frame.StompHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>This object represents a STOMP heart-beat. Its string representation (via <code class="xref py py-meth docutils literal"><span class="pre">__str__()</span></code>) renders the wire-level STOMP heart-beat.</p>
</dd></dl>

</div>
<div class="section" id="commands">
<span id="id2"></span><h2>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-stompest.protocol.commands"></span><p>This module implements a low-level and stateless API for all commands of the STOMP protocol version supported by stompest. All STOMP command frames are represented as <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><code class="xref py py-class docutils literal"><span class="pre">StompFrame</span></code></a> objects. It forms the basis for <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><code class="xref py py-class docutils literal"><span class="pre">StompSession</span></code></a> which represents the full state of an abstract STOMP protocol session and (via <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><code class="xref py py-class docutils literal"><span class="pre">StompSession</span></code></a>) of both high-level STOMP clients. You can use the commands API independently of other stompest modules to roll your own STOMP related functionality.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Whenever you have to pass a <strong>version</strong> parameter to a command, this is because the behavior of that command depends on the STOMP protocol version of your current session. The default version is the value of <code class="xref py py-attr docutils literal"><span class="pre">StompSpec.DEFAULT_VERSION</span></code>, which is currently <code class="xref py py-obj docutils literal"><span class="pre">'1.0'</span></code> but may change in upcoming versions of stompest (or you might override it yourself). Any command which does not conform to the STOMP protocol version in question will result in a <a class="reference internal" href="error.html#stompest.error.StompProtocolError" title="stompest.error.StompProtocolError"><code class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></code></a>. The <strong>version</strong> parameter will always be the last argument in the signature; since command signatures may vary with a new STOMP protocol version, you are advised to always specify it as a keyword (as opposed to a positional) argument.</p>
</div>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">commands</span><span class="p">,</span> <span class="n">StompFrame</span><span class="p">,</span> <span class="n">StompSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">versions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">versions</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">VERSION_1_1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">versions</span>
<span class="go">[&#39;1.0&#39;, &#39;1.1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">versions</span><span class="o">=</span><span class="n">versions</span><span class="p">)</span>
<span class="go">StompFrame(command=&#39;CONNECT&#39;, headers={&#39;host&#39;: &#39;&#39;, &#39;accept-version&#39;: &#39;1.0,1.1&#39;})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s1">&#39;/queue/test&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">ACK_HEADER</span><span class="p">:</span> <span class="s1">&#39;client-individual&#39;</span><span class="p">,</span> <span class="s1">&#39;activemq.prefetchSize&#39;</span><span class="p">:</span> <span class="s1">&#39;100&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">StompFrame</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">MESSAGE</span><span class="p">,</span> <span class="p">{</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">DESTINATION_HEADER</span><span class="p">:</span> <span class="s1">&#39;/queue/test&#39;</span><span class="p">,</span> <span class="n">StompSpec</span><span class="o">.</span><span class="n">MESSAGE_ID_HEADER</span><span class="p">:</span> <span class="s1">&#39;007&#39;</span><span class="p">},</span> <span class="n">b</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span>
<span class="go">StompFrame(command=&#39;MESSAGE&#39;, headers={&#39;destination&#39;: &#39;/queue/test&#39;, &#39;message-id&#39;: &#39;007&#39;}, body=b&#39;hello&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span> <span class="o">==</span> <span class="n">token</span> <span class="c1"># This message matches your subscription.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">(&#39;destination&#39;, &#39;/queue/test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">StompSpec</span><span class="o">.</span><span class="n">VERSION_1_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">stompest.error.StompProtocolError</span>: <span class="n">Invalid MESSAGE frame (subscription header mandatory in version 1.1) [headers={&#39;destination&#39;: &#39;/queue/test&#39;, &#39;message-id&#39;: &#39;007&#39;}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">receipt</span><span class="o">=</span><span class="s1">&#39;message-12345&#39;</span><span class="p">)</span>
<span class="go">StompFrame(command=&#39;DISCONNECT&#39;, headers={&#39;receipt&#39;: &#39;message-12345&#39;})</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Specification of STOMP protocols <a class="reference external" href="http://stomp.github.com//stomp-specification-1.0.html">1.0</a> and <a class="reference external" href="http://stomp.github.com//stomp-specification-1.1.html">1.1</a>, your favorite broker&#8217;s documentation for additional STOMP headers.</p>
</div>
<dl class="function">
<dt id="stompest.protocol.commands.abort">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">abort</code><span class="sig-paren">(</span><em>transaction</em>, <em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ABORT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>transaction</strong> &#8211; The id of the transaction.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.ack">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">ack</code><span class="sig-paren">(</span><em>frame</em>, <em>transactions=None</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.ack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> &#8211; The <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><code class="xref py py-class docutils literal"><span class="pre">StompFrame</span></code></a> object representing the <strong>MESSAGE</strong> frame we wish to ack.</li>
<li><strong>transactions</strong> &#8211; The ids of currently active transactions &#8212; only if the <strong>frame</strong> is part of one of these transactions, the <strong>transaction</strong> header is included in the ACK frame.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-func docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.beat">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">beat</code><span class="sig-paren">(</span><em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.beat" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a STOMP heart-beat.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.begin">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">begin</code><span class="sig-paren">(</span><em>transaction</em>, <em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>BEGIN</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>transaction</strong> &#8211; The id of the transaction.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.commit">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">commit</code><span class="sig-paren">(</span><em>transaction</em>, <em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>COMMIT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>transaction</strong> &#8211; The id of the transaction.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.connect">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">connect</code><span class="sig-paren">(</span><em>login=None</em>, <em>passcode=None</em>, <em>headers=None</em>, <em>versions=None</em>, <em>host=None</em>, <em>heartBeats=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>CONNECT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>login</strong> &#8211; The <strong>login</strong> header. The default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, which means that no such header will be added.</li>
<li><strong>passcode</strong> &#8211; The <strong>passcode</strong> header. The default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, which means that no such header will be added.</li>
<li><strong>headers</strong> &#8211; Additional STOMP headers.</li>
<li><strong>versions</strong> &#8211; A list of the STOMP versions we wish to support. The default is <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, which means that we will offer the broker to accept any version prior or equal to the default STOMP protocol version.</li>
<li><strong>host</strong> &#8211; The <strong>host</strong> header which gives this client a human readable name on the broker side.</li>
<li><strong>heartBeats</strong> &#8211; A pair (client heart-beat, server heart-beat) of integer heart-beat intervals in ms. Both intervals must be non-negative. A client heart-beat of 0 means that no heart-beats will be sent by the client. Similarly, a server heart-beat of 0 means that the client does not expect heart-beats from the server.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.connected">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">connected</code><span class="sig-paren">(</span><em>frame</em>, <em>versions=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>CONNECTED</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>versions</strong> &#8211; The same <strong>versions</strong> parameter you used to create the <strong>CONNECT</strong> frame.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.disconnect">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">disconnect</code><span class="sig-paren">(</span><em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>DISCONNECT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>receipt</strong> &#8211; Add a <strong>receipt</strong> header with this id to request a <strong>RECEIPT</strong> frame from the broker. If <code class="xref py py-obj docutils literal"><span class="pre">None</span></code>, no such header is added.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.error">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">error</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle an <strong>ERROR</strong> frame. Does not really do anything except checking that this is an <strong>ERROR</strong> frame.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.message">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">message</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>MESSAGE</strong> frame. Returns a token which you can use to match this message to its subscription.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#stompest.protocol.commands.subscribe" title="stompest.protocol.commands.subscribe"><code class="xref py py-func docutils literal"><span class="pre">subscribe()</span></code></a> command.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.nack">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">nack</code><span class="sig-paren">(</span><em>frame</em>, <em>transactions=None</em>, <em>receipt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.nack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>NACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> &#8211; The <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><code class="xref py py-class docutils literal"><span class="pre">StompFrame</span></code></a> object representing the <strong>MESSAGE</strong> frame we wish to nack.</li>
<li><strong>transactions</strong> &#8211; The ids of currently active transactions &#8212; only if the <strong>frame</strong> is part of one of these transactions, the <strong>transaction</strong> header is included in the NACK frame.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-func docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.negotiateHeartBeat">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">negotiateHeartBeat</code><span class="sig-paren">(</span><em>client</em>, <em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.negotiateHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the negotiated heart-beating period.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>client</strong> &#8211; The client&#8217;s proposed heart-beating period.</li>
<li><strong>server</strong> &#8211; The server&#8217;s proposed heart-beating period.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.receipt">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">receipt</code><span class="sig-paren">(</span><em>frame</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.receipt" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>RECEIPT</strong> frame. Returns the receipt id which you can use to match this receipt to the command that requested it.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.send">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">send</code><span class="sig-paren">(</span><em>destination</em>, <em>body=''</em>, <em>headers=None</em>, <em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>SEND</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>destination</strong> &#8211; Destination for the frame.</li>
<li><strong>body</strong> &#8211; Binary message body. If the body contains null-bytes, it must be accompanied by the STOMP header <strong>content-length</strong> which specifies the number of bytes in the message body.</li>
<li><strong>headers</strong> &#8211; Additional STOMP headers.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-func docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.stomp">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">stomp</code><span class="sig-paren">(</span><em>login=None</em>, <em>passcode=None</em>, <em>headers=None</em>, <em>versions=None</em>, <em>host=None</em>, <em>heartBeats=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.stomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>STOMP</strong> frame. Not supported in STOMP protocol 1.0, synonymous to <a class="reference internal" href="#stompest.protocol.commands.connect" title="stompest.protocol.commands.connect"><code class="xref py py-func docutils literal"><span class="pre">connect()</span></code></a> for STOMP protocol 1.1 and higher.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.subscribe">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">subscribe</code><span class="sig-paren">(</span><em>destination</em>, <em>headers</em>, <em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.subscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pair (frame, token) of a <strong>SUBSCRIBE</strong> frame and a token which you have to keep if you wish to match incoming <strong>MESSAGE</strong> frames to this subscription  with <a class="reference internal" href="#stompest.protocol.commands.message" title="stompest.protocol.commands.message"><code class="xref py py-func docutils literal"><span class="pre">message()</span></code></a> or to <a class="reference internal" href="#stompest.protocol.commands.unsubscribe" title="stompest.protocol.commands.unsubscribe"><code class="xref py py-func docutils literal"><span class="pre">unsubscribe()</span></code></a> later.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>destination</strong> &#8211; Destination for the subscription.</li>
<li><strong>headers</strong> &#8211; Additional STOMP headers.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-func docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.unsubscribe">
<code class="descclassname">stompest.protocol.commands.</code><code class="descname">unsubscribe</code><span class="sig-paren">(</span><em>token</em>, <em>receipt=None</em>, <em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.commands.unsubscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>UNSUBSCRIBE</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>token</strong> &#8211; The result of the <a class="reference internal" href="#stompest.protocol.commands.subscribe" title="stompest.protocol.commands.subscribe"><code class="xref py py-func docutils literal"><span class="pre">subscribe()</span></code></a> command which you used to initiate the subscription in question.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><code class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.spec">
<span id="stomp-protocol-specification"></span><span id="spec"></span><h2>STOMP Protocol Specification<a class="headerlink" href="#module-stompest.protocol.spec" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.spec.StompSpec">
<em class="property">class </em><code class="descclassname">stompest.protocol.spec.</code><code class="descname">StompSpec</code><a class="headerlink" href="#stompest.protocol.spec.StompSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>This class hosts all constants related to the STOMP protocol specification in its various versions. There really isn&#8217;t much to document, but you are invited to take a look at all available constants in the source code. Wait a minute ... one attribute is particularly noteworthy, name <code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_VERSION</span></code> &#8212; which currently is <code class="xref py py-obj docutils literal"><span class="pre">'1.0'</span></code> (but this may change in upcoming stompest releases, so you&#8217;re advised to always explicitly define which STOMP protocol version you are going to use).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Specification of <a class="reference external" href="http://stomp.github.com//index.html">STOMP protocol</a>, your favorite broker&#8217;s documentation for additional STOMP headers.</p>
</div>
<dl class="classmethod">
<dt id="stompest.protocol.spec.StompSpec.version">
<em class="property">classmethod </em><code class="descname">version</code><span class="sig-paren">(</span><em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.spec.StompSpec.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether <strong>version</strong> is a valid STOMP protocol version.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>version</strong> &#8211; A candidate version, or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (which is equivalent to the value of <code class="xref py py-attr docutils literal"><span class="pre">StompSpec.DEFAULT_VERSION</span></code>).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="stompest.protocol.spec.StompSpec.versions">
<em class="property">classmethod </em><code class="descname">versions</code><span class="sig-paren">(</span><em>version</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.spec.StompSpec.versions" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain all versions prior or equal to <strong>version</strong>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.parser">
<span id="wire-level-parser"></span><span id="parser"></span><h2>Wire-Level Parser<a class="headerlink" href="#module-stompest.protocol.parser" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.parser.StompParser">
<em class="property">class </em><code class="descclassname">stompest.protocol.parser.</code><code class="descname">StompParser</code><span class="sig-paren">(</span><em>version=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.parser.StompParser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a parser for a wire-level byte-stream of STOMP frames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>version</strong> &#8211; A valid STOMP protocol version, or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (equivalent to the <code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_VERSION</span></code> attribute of the <a class="reference internal" href="#stompest.protocol.spec.StompSpec" title="stompest.protocol.spec.StompSpec"><code class="xref py py-class docutils literal"><span class="pre">StompSpec</span></code></a> class).</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">StompParser</span><span class="p">(</span><span class="s1">&#39;1.0&#39;</span><span class="p">)</span> <span class="c1"># STOMP 1.0 does not support the NACK command.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">messages</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="s1">&#39;RECEIPT</span><span class="se">\n</span><span class="s1">receipt-id:message-12345</span><span class="se">\n\n\x00</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">b</span><span class="s1">&#39;NACK</span><span class="se">\n</span><span class="s1">subscription:0</span><span class="se">\n</span><span class="s1">message-id:007</span><span class="se">\n\n\x00</span><span class="s1">&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">... </span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">stompest.error.StompFrameError</span>: <span class="n">Invalid command: &#39;NACK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">StompFrame(command=&#39;RECEIPT&#39;, rawHeaders=[(&#39;receipt-id&#39;, &#39;message-12345&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">canRead</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">StompParser</span><span class="p">(</span><span class="s1">&#39;1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">messages</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">StompFrame(command=&#39;NACK&#39;, rawHeaders=[(&#39;subscription&#39;, &#39;0&#39;), (&#39;message-id&#39;, &#39;007&#39;)], version=&#39;1.1&#39;)    </span>
</pre></div>
</div>
<dl class="method">
<dt id="stompest.protocol.parser.StompParser.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.parser.StompParser.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a byte-stream of wire-level data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> &#8211; A byte-stream, i.e., a <code class="xref py py-class docutils literal"><span class="pre">str</span></code>-like (Python 2) or <code class="xref py py-class docutils literal"><span class="pre">bytes</span></code>-like (Python 3) object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.parser.StompParser.canRead">
<code class="descname">canRead</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.parser.StompParser.canRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether there are frames available.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.parser.StompParser.get">
<code class="descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.parser.StompParser.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the next frame as a <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><code class="xref py py-class docutils literal"><span class="pre">StompFrame</span></code></a> object (if any), or <code class="xref py py-obj docutils literal"><span class="pre">None</span></code> (otherwise).</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.parser.StompParser.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stompest.protocol.parser.StompParser.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal state, including all fully or partially parsed frames.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="config.html" title="Configuration"
             >next</a> |</li>
        <li class="right" >
          <a href="async.html" title="Asynchronous Client"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">stompest documentation - v2.2.5</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Jan Müller.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>